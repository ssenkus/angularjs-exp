<!DOCTYPE html>
<html >
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <style>
            body {
                font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;
                margin: auto;
                position: relative;
                text-align: center;

            }
            svg {
                border: 0px solid rgba(0, 0, 0, 0.5);
                margin: 20px auto;
                background-color: rgb(0,0,0)!important;

            }
            circle {
                border-radius: 10%;
                pointer-events: all;
                transition: 2s all linear;
            }
            circle:hover {
                fill: #ff0;
                opacity: 1;
            }

        </style>
        <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.1/angular.min.js"></script>
        <script src='//cdnjs.cloudflare.com/ajax/libs/d3/3.3.3/d3.min.js'></script>
    </head>
    <body>
        <div ng-app="shapeApp"> 
            <div ng-controller="SvgController">
                <svg width="400" height="400" style="background-color: #fff;"></svg>
                <p>D3.js & Angular JS</p>
                <label>Number of circles: </label>
                <input type="number" style="clear:both; margin: 20px;" ng-model='numEls' />
                <select ng-model="type">
                    <option value="">-- select an SVG type -- </option>
                    <option ng-repeat="svg in svgs" value="{{svg}}">{{svg}}(s)</option>
                </select>                
                <button ng-click="add()" type="button">Add</button>

            </div>
        </div>
        <script>

            var shapeApp = angular.module('shapeApp', []);
            shapeApp.controller('SvgController', function($scope) {
                function Rect(opts) {
                    this.x = 100;
                    this.y = 100;
                    this.width = 4;
                    this.height = 4;
                    this.fill = '#f00';
                    var svgContainer = d3.select('svg');
                    var rectangle = svgContainer.append("rect")
                        .attr("x", function() {
                        return Math.random() * 400;
                    })
                        .attr("y", function() {
                        return Math.random() * 400;
                    })
                        .attr("width", 100)
                        .attr("height", 100)
                        .style('fill', function() {
                        return color(Math.random() * 20 + 1);

                    })
                        .transition()
                        .duration(1000)
                        .style('opacity', 0);
                }

                function Circle() {
                    this.fill = '#f00';
                    var svgContainer = d3.select('svg');
                    var rectangle = svgContainer.append("circle")
                        .attr("cx", function() {
                        return Math.random() * 400;
                    })
                        .attr("cy", function() {
                        return Math.random() * 400;
                    })
                        .attr("r", 20)
                        .style('fill', function() {
                        return color(Math.random() * 20 + 1);

                    })
                        .transition()
                        .duration(1000)
                        .style('opacity', 0);
                }

                var color = d3.scale.category20c();
                $scope.circleCount = 0;
                $scope.svgs = ['circle', 'rect'];
                $scope.add = function() {
                    for (var i = 0; i < $scope.numEls; i++) {
                        switch ($scope.type) {
                            case 'circle':
                                var circle = new Circle();
                                break;
                            case 'rect':
                                var rect = new Rect();
                                break;
                            default:
                                console.log('switch fallthrough');
                                break;
                        }
                    }

                };
            });

            /*          
             var color = d3.scale.category20();
             var color2 = d3.scale.category20c();
             var dataset = [];
             for (var i = 0; i < 100; i++) {
             dataset.push(Math.random() * i * 20);
             }
             
             function squares() {
             d3.select('svg')
             .selectAll("circle")
             .data(dataset.reverse())
             .enter()
             .append("circle")
             .attr("cx", function(d) {
             return (Math.random() * 800);
             })
             .attr("cy", function(d) {
             return (Math.random() * 800);
             })
             .attr("r", function(d) {
             return d / 200;
             })
             
             .attr("fill", function(d, i) {
             return color(i);
             })
             .style('opacity', 0.1)
             .transition()
             .duration(function(d) {
             return ((Math.random() * 30) * 500) + 200
             })
             .style('transform', 'scale(0.5,0.5)')
             .style('opacity', 0.5)
             .transition()
             .duration(function(d) {
             return ((Math.random() * 30) * 500) + 200
             })
             .attr("cx", function(d) {
             return (Math.random() * 700);
             })
             .attr("cy", function(d) {
             return (Math.random() * 500);
             })
             .attr("fill", function(d, i) {
             return color2(Math.random() * i);
             })
             .style('opacity', 0.9)
             .style('transform', 'scale(2.0,2.0)');
             
             /* ********A message 
             
             
             
             d3.select('svg')
             .selectAll("text")
             .data(['hey there'])
             .enter()
             .append('text')
             .style('font-size', '50px')
             .attr('x', 100)
             .attr('y', 200)
             .attr('fill', '#fff')
             .attr('filter', 'brightness(5%)')
             .style('text-shadow','2px 2px 2px #f00')
             .text(function (d) {
             return d;
             });
             }
             
             
             
             function swapSVGLayers(cb) {
             
             var rndEl, timer;
             timer = setInterval(function() {
             var rects = document.getElementsByTagName('circle');
             rndEl = (Math.floor(Math.random() * rects.length));
             if (rects.length === 100) {
             squares();
             }
             document.getElementsByTagName('svg')[0].removeChild(document.getElementsByTagName('circle')[rndEl]);
             }, 100);
             return;
             }
             
             squares();
             swapSVGLayers(squares);
             */



        </script>

    </body>
</html>
